# 目的

任意のログテキストからIPアドレスを抽出し、 国別の通信頻度を可視化することで、
アクセス先・アクセス元の傾向を直感的に把握できるようにする。

## 機能要件

| 機能 | 詳細                                                                                                                                                                                                                                                                                                                                                                                                      |
| :--- |:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1. ログ入力 | - ユーザーが任意のテキスト（アクセスログなど）を貼り付けられる大きなテキストエリアを画面に表示する。<br>- 解析を実行するための「解析」ボタンを設置する。                                                                                                                                                                                                                                                                                                                        |
| 2. IPアドレス抽出 | - 「解析」ボタンが押されたら、バックエンドでテキストエリアの内容を受け取る。正規表現を用いて、テキスト内からIPv4アドレスをすべて抽出する。                                                                                                                                                                                                                                                                                                                                |
| 3. GeoIPによる情報付与 | - 抽出した各IPアドレスに対して、GeoIPデータベース（例: MaxMind GeoLite2）を用いて国名を特定する。<br>- データベースに存在しない、またはプライベートIPアドレスの場合は「不明」として扱い、「不明」という国名で集計の対象とする。                                                                                                                                                                                                                                                                       |
| 4. データ集計 | - 国ごとのIPアドレス出現回数を集計する。<br>- IPアドレスごとの出現回数を集計する。                                                                                                                                                                                                                                                                                                                                                         |
| 5. 結果の可視化 | a. サマリー表示<br>   - 総ログ行数（参考値）、抽出したユニークIPアドレス数などを表示する。<br><br>b. 集計テーブル<br>   - 「国名」「IPアドレス」「出現回数」を一覧表示するテーブルを作成する。<br>   - カラム（列）でのソート機能（昇順/降順）を設ける。<br>   - （任意）ページネーション機能（件数が多い場合のため）。<br><br>c. グラフ表示<br>   - 国別のアクセス数を棒グラフで表示する。<br>   - グラフの種類（棒グラフ、円グラフなど）を選択できるとより良い。<br><br>d. 世界地図ヒートマップ<br>   - 世界地図を表示する。<br>   - 国別のアクセス数に応じて、色を塗り分ける（多いほど濃い色など）。<br>   - 国にカーソルを合わせると、国名とアクセス数をツールチップで表示する。 |
| 6. エラーハンドリング | - IPアドレスが一つも抽出できなかった場合に、その旨をユーザーに通知する。<br>- タイムアウトなど、予期せぬエラーが発生した場合にエラーメッセージを表示する。                                                                                                                                                                                                                                                                                                                      |


## 非機能要件

| 項目 | 詳細 | 
| :--- | :--- | 
| パフォーマンス | - 大量のログ（例: 10万行以上）を貼り付けた場合でも、現実的な時間（例: 10秒以内）で解析が完了することを目指す。<br>- 処理中は、ユーザーに処理中であることがわかるようにローディングインジケーター（スピナーなど）を表示する。 | 
| ユーザビリティ | - 直感的で分かりやすいUIを提供する。<br>- レスポンシブデザインに対応し、PCでもスマートフォンでも適切に表示されるようにする。 | 
| セキュリティ | - ユーザーが入力したテキストをサーバー側で適切に処理し、XSS（クロスサイトスクリプティング）などの脆弱性を生まないようにする。（入力値をそのままHTMLにレンダリングしない） |

## 技術選定

| 分類      | 技術                            | 目的・ライブラリ |
|:--------|:------------------------------| :--- | 
| バックエンド  | Python 3                      | プログラミング言語 |
|         | Flask                         | Webフレームワーク | | 
| geoip2  | MaxMindのDBを読み込むためのPythonライブラリ | 
| フロントエンド | HTML/CSS/JavaScript           | UIの基本 | 
|         | Chart.js                      | グラフ描画ライブラリ（シンプルで導入が容易） |
|         | Leaflet.js                    | 地図描画ライブラリ（軽量で高機能） |
| 　       | Bootstrap                     | UIデザインを整えるためのCSSフレームワーク |